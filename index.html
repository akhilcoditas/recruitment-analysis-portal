<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Recruitment Analytics Dashboard</title>
    <link rel="stylesheet" href="css/style.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <div class="app-container">
      <!-- Header -->
      <header class="header">
        <div class="logo">
          <span class="logo-icon">‚óà</span>
          <span class="logo-text">Recruitment Analytics</span>
        </div>
        <div class="header-actions">
          <button class="btn btn-refresh" id="refreshBtn" title="Refresh Data">
            <svg
              width="18"
              height="18"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <path d="M23 4v6h-6M1 20v-6h6" />
              <path
                d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"
              />
            </svg>
          </button>
          <button class="btn btn-settings" id="settingsBtn" title="Settings">
            <svg
              width="18"
              height="18"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <circle cx="12" cy="12" r="3" />
              <path
                d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"
              />
            </svg>
          </button>
        </div>
      </header>

      <!-- Settings Modal -->
      <div class="modal-overlay" id="settingsModal">
        <div class="modal">
          <div class="modal-header">
            <h2>Connect Google Sheet</h2>
            <button class="modal-close" id="closeModal">&times;</button>
          </div>
          <div class="modal-body">
            <div class="form-group">
              <label for="webAppUrl">Apps Script Web App URL</label>
              <input
                type="text"
                id="webAppUrl"
                placeholder="https://script.google.com/macros/s/YOUR_SCRIPT_ID/exec"
              />
              <p class="form-hint">
                Paste the Web App URL from your deployed Apps Script
              </p>
            </div>
            <div class="instructions">
              <h3>üîí Secure Setup:</h3>
              <ol>
                <li>Open your Google Sheet</li>
                <li>Go to <strong>Extensions ‚Üí Apps Script</strong></li>
                <li>Paste the script from <code>apps-script-code.js</code></li>
                <li>Click <strong>Deploy ‚Üí New deployment</strong></li>
                <li>Select type: <strong>Web app</strong></li>
                <li>Set "Who has access" to <strong>Anyone</strong></li>
                <li>Click <strong>Deploy</strong> and authorize</li>
                <li>Copy the <strong>Web app URL</strong> and paste above</li>
              </ol>
            </div>
          </div>
          <div class="modal-footer">
            <button class="btn btn-secondary" id="cancelBtn">Cancel</button>
            <button class="btn btn-primary" id="saveBtn">Connect</button>
          </div>
        </div>
      </div>

      <!-- Column Mapping Modal -->
      <div class="modal-overlay" id="mappingModal">
        <div class="modal modal-large">
          <div class="modal-header">
            <h2>Map Your Spreadsheet Columns</h2>
            <button class="modal-close" id="closeMappingModal">&times;</button>
          </div>
          <div class="modal-body">
            <p class="mapping-intro">
              Select which columns in your spreadsheet correspond to each field:
            </p>
            <div class="mapping-grid" id="mappingGrid">
              <!-- Will be populated by JS -->
            </div>
          </div>
          <div class="modal-footer">
            <button class="btn btn-secondary" id="cancelMappingBtn">
              Cancel
            </button>
            <button class="btn btn-primary" id="saveMappingBtn">
              Save Mapping
            </button>
          </div>
        </div>
      </div>

      <!-- Main Content -->
      <main class="main-content">
        <!-- Status Bar -->
        <div class="status-bar" id="statusBar">
          <div class="status-indicator" id="statusIndicator">
            <span class="status-dot"></span>
            <span class="status-text">Not Connected</span>
          </div>
          <div class="status-actions">
            <button
              class="btn btn-small"
              id="mapColumnsBtn"
              style="display: none"
            >
              <svg
                width="14"
                height="14"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <path
                  d="M12 3h7a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-7m0-18H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h7m0-18v18"
                />
              </svg>
              Map Columns
            </button>
            <span class="last-updated" id="lastUpdated"></span>
          </div>
        </div>

        <!-- Empty State -->
        <div class="empty-state" id="emptyState">
          <div class="empty-icon">
            <svg
              width="80"
              height="80"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="1.5"
            >
              <path
                d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"
              />
              <polyline points="14 2 14 8 20 8" />
              <line x1="16" y1="13" x2="8" y2="13" />
              <line x1="16" y1="17" x2="8" y2="17" />
            </svg>
          </div>
          <h2>No Data Source Connected</h2>
          <p>Connect your recruitment tracking Google Sheet</p>
          <button class="btn btn-primary btn-large" id="connectBtn">
            <svg
              width="20"
              height="20"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <path
                d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"
              />
              <path
                d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"
              />
            </svg>
            Connect Google Sheet
          </button>
        </div>

        <!-- Loading State -->
        <div class="loading-state" id="loadingState">
          <div class="loader"></div>
          <p>Fetching recruitment data...</p>
        </div>

        <!-- Dashboard Container -->
        <div class="dashboard-container" id="dashboardContainer">
          <!-- Top Metrics Row -->
          <section class="dashboard-section">
            <h2 class="section-title">üìä Overview</h2>
            <div class="metrics-grid metrics-4">
              <div class="metric-card metric-blue">
                <div class="metric-icon">üì•</div>
                <div class="metric-content">
                  <span class="metric-value" id="totalProfiles">0</span>
                  <span class="metric-label">Profiles Received</span>
                </div>
              </div>
              <div class="metric-card metric-purple">
                <div class="metric-icon">üìÖ</div>
                <div class="metric-content">
                  <span class="metric-value" id="interviewsScheduled">0</span>
                  <span class="metric-label">Interviews Scheduled</span>
                </div>
              </div>
              <div class="metric-card metric-green">
                <div class="metric-icon">‚úÖ</div>
                <div class="metric-content">
                  <span class="metric-value" id="totalOffers">0</span>
                  <span class="metric-label">Offers Released</span>
                </div>
              </div>
              <div class="metric-card metric-teal">
                <div class="metric-icon">üéâ</div>
                <div class="metric-content">
                  <span class="metric-value" id="totalOnboarded">0</span>
                  <span class="metric-label">Onboarded</span>
                </div>
              </div>
            </div>
          </section>

          <!-- Interview Funnel -->
          <section class="dashboard-section">
            <h2 class="section-title">üéØ Interview Funnel</h2>
            <div class="funnel-container">
              <div class="funnel-stage">
                <div class="funnel-bar" id="screeningBar">
                  <span class="funnel-count" id="screenedCount">0</span>
                </div>
                <span class="funnel-label">Screened</span>
              </div>
              <div class="funnel-arrow">‚Üí</div>
              <div class="funnel-stage">
                <div class="funnel-bar" id="rapidFireBar">
                  <span class="funnel-count" id="rapidFireCount">0</span>
                </div>
                <span class="funnel-label">Rapid Fire</span>
              </div>
              <div class="funnel-arrow">‚Üí</div>
              <div class="funnel-stage">
                <div class="funnel-bar" id="l1Bar">
                  <span class="funnel-count" id="l1Count">0</span>
                </div>
                <span class="funnel-label">L1 Round</span>
              </div>
              <div class="funnel-arrow">‚Üí</div>
              <div class="funnel-stage">
                <div class="funnel-bar" id="l2Bar">
                  <span class="funnel-count" id="l2Count">0</span>
                </div>
                <span class="funnel-label">L2 Round</span>
              </div>
              <div class="funnel-arrow">‚Üí</div>
              <div class="funnel-stage">
                <div class="funnel-bar" id="clientBar">
                  <span class="funnel-count" id="clientCount">0</span>
                </div>
                <span class="funnel-label">Client Round</span>
              </div>
            </div>
          </section>

          <!-- Outcomes Grid -->
          <section class="dashboard-section">
            <h2 class="section-title">üìà Stage Outcomes</h2>
            <div class="outcomes-grid">
              <!-- Screening Outcome -->
              <div class="outcome-card">
                <h3>Screening</h3>
                <div class="outcome-bars">
                  <div class="outcome-row">
                    <span class="outcome-label">Selected</span>
                    <div class="outcome-bar-container">
                      <div
                        class="outcome-bar outcome-success"
                        id="screeningSelectedBar"
                      ></div>
                    </div>
                    <span class="outcome-value" id="screeningSelected">0</span>
                  </div>
                  <div class="outcome-row">
                    <span class="outcome-label">Rejected</span>
                    <div class="outcome-bar-container">
                      <div
                        class="outcome-bar outcome-danger"
                        id="screeningRejectedBar"
                      ></div>
                    </div>
                    <span class="outcome-value" id="screeningRejected">0</span>
                  </div>
                  <div class="outcome-row">
                    <span class="outcome-label">Hold</span>
                    <div class="outcome-bar-container">
                      <div
                        class="outcome-bar outcome-warning"
                        id="screeningHoldBar"
                      ></div>
                    </div>
                    <span class="outcome-value" id="screeningHold">0</span>
                  </div>
                </div>
              </div>

              <!-- Rapid Fire Outcome -->
              <div class="outcome-card">
                <h3>Rapid Fire</h3>
                <div class="outcome-bars">
                  <div class="outcome-row">
                    <span class="outcome-label">Passed</span>
                    <div class="outcome-bar-container">
                      <div
                        class="outcome-bar outcome-success"
                        id="rapidFirePassedBar"
                      ></div>
                    </div>
                    <span class="outcome-value" id="rapidFirePassed">0</span>
                  </div>
                  <div class="outcome-row">
                    <span class="outcome-label">Rejected</span>
                    <div class="outcome-bar-container">
                      <div
                        class="outcome-bar outcome-danger"
                        id="rapidFireRejectedBar"
                      ></div>
                    </div>
                    <span class="outcome-value" id="rapidFireRejected">0</span>
                  </div>
                </div>
              </div>

              <!-- L1 Outcome -->
              <div class="outcome-card">
                <h3>L1 Technical</h3>
                <div class="outcome-bars">
                  <div class="outcome-row">
                    <span class="outcome-label">Selected</span>
                    <div class="outcome-bar-container">
                      <div
                        class="outcome-bar outcome-success"
                        id="l1SelectedBar"
                      ></div>
                    </div>
                    <span class="outcome-value" id="l1Selected">0</span>
                  </div>
                  <div class="outcome-row">
                    <span class="outcome-label">Rejected</span>
                    <div class="outcome-bar-container">
                      <div
                        class="outcome-bar outcome-danger"
                        id="l1RejectedBar"
                      ></div>
                    </div>
                    <span class="outcome-value" id="l1Rejected">0</span>
                  </div>
                </div>
              </div>

              <!-- L2 Outcome -->
              <div class="outcome-card">
                <h3>L2 Technical</h3>
                <div class="outcome-bars">
                  <div class="outcome-row">
                    <span class="outcome-label">Selected</span>
                    <div class="outcome-bar-container">
                      <div
                        class="outcome-bar outcome-success"
                        id="l2SelectedBar"
                      ></div>
                    </div>
                    <span class="outcome-value" id="l2Selected">0</span>
                  </div>
                  <div class="outcome-row">
                    <span class="outcome-label">Rejected</span>
                    <div class="outcome-bar-container">
                      <div
                        class="outcome-bar outcome-danger"
                        id="l2RejectedBar"
                      ></div>
                    </div>
                    <span class="outcome-value" id="l2Rejected">0</span>
                  </div>
                </div>
              </div>

              <!-- Client Round Outcome -->
              <div class="outcome-card">
                <h3>Client Round</h3>
                <div class="outcome-bars">
                  <div class="outcome-row">
                    <span class="outcome-label">Selected</span>
                    <div class="outcome-bar-container">
                      <div
                        class="outcome-bar outcome-success"
                        id="clientSelectedBar"
                      ></div>
                    </div>
                    <span class="outcome-value" id="clientSelected">0</span>
                  </div>
                  <div class="outcome-row">
                    <span class="outcome-label">Rejected</span>
                    <div class="outcome-bar-container">
                      <div
                        class="outcome-bar outcome-danger"
                        id="clientRejectedBar"
                      ></div>
                    </div>
                    <span class="outcome-value" id="clientRejected">0</span>
                  </div>
                </div>
              </div>
            </div>
          </section>

          <!-- Quality Metrics -->
          <section class="dashboard-section">
            <h2 class="section-title">üü• Quality Metrics</h2>
            <div class="metrics-grid metrics-3">
              <div class="metric-card metric-red">
                <div class="metric-icon">üö´</div>
                <div class="metric-content">
                  <span class="metric-value" id="noShowCount">0</span>
                  <span class="metric-label">No Shows</span>
                </div>
              </div>
              <div class="metric-card metric-orange">
                <div class="metric-icon">‚ùå</div>
                <div class="metric-content">
                  <span class="metric-value" id="technicalRejections">0</span>
                  <span class="metric-label">Technical Rejections</span>
                </div>
              </div>
              <div class="metric-card metric-pink">
                <div class="metric-icon">üë§</div>
                <div class="metric-content">
                  <span class="metric-value" id="hrRejections">0</span>
                  <span class="metric-label">HR Rejections</span>
                </div>
              </div>
            </div>
          </section>

          <!-- Vendor Performance -->
          <section class="dashboard-section">
            <h2 class="section-title">üë• Vendor Performance</h2>
            <div class="table-container">
              <table class="data-table" id="vendorTable">
                <thead>
                  <tr>
                    <th>Vendor</th>
                    <th>Profiles</th>
                    <th>Screened</th>
                    <th>Selected</th>
                    <th>Rejected</th>
                    <th>Success Rate</th>
                  </tr>
                </thead>
                <tbody id="vendorTableBody">
                  <!-- Populated by JS -->
                </tbody>
              </table>
            </div>
          </section>

          <!-- Technology & Experience Summary -->
          <section class="dashboard-section">
            <div class="summary-grid">
              <!-- Technology Summary -->
              <div class="summary-card">
                <h3>üíª Technology-wise Summary</h3>
                <div class="summary-list" id="techSummary">
                  <!-- Populated by JS -->
                </div>
              </div>

              <!-- Experience Summary -->
              <div class="summary-card">
                <h3>üìä Experience Bracket</h3>
                <div class="summary-list" id="expSummary">
                  <!-- Populated by JS -->
                </div>
              </div>
            </div>
          </section>
        </div>

        <!-- Error State -->
        <div class="error-state" id="errorState">
          <div class="error-icon">‚ö†Ô∏è</div>
          <h2>Unable to Load Data</h2>
          <p id="errorMessage">
            Something went wrong while fetching your data.
          </p>
          <button class="btn btn-primary" id="retryBtn">Try Again</button>
        </div>
      </main>

      <!-- Footer -->
      <footer class="footer">
        <p>üîí Secure connection via Google Apps Script</p>
      </footer>
    </div>

    <script src="js/config.js"></script>
    <script src="js/sheets.js"></script>
    <script src="js/analytics.js"></script>
    <script src="js/app.js"></script>
  </body>
</html>
