<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>TalentPulse - Recruitment Analytics</title>
    <link rel="stylesheet" href="css/style.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <div class="app-container">
      <!-- Header -->
      <header class="header">
        <div class="logo">
          <div class="logo-icon-container">
            <span class="logo-icon">‚ö°</span>
            <span class="logo-pulse"></span>
          </div>
          <span class="logo-text"
            >Talent<span class="logo-highlight">Pulse</span></span
          >
        </div>
        <div class="header-actions">
          <button class="btn btn-refresh" id="refreshBtn" title="Refresh Data">
            <svg
              width="18"
              height="18"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <path d="M23 4v6h-6M1 20v-6h6" />
              <path
                d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"
              />
            </svg>
          </button>
          <button class="btn btn-settings" id="settingsBtn" title="Settings">
            <svg
              width="18"
              height="18"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <circle cx="12" cy="12" r="3" />
              <path
                d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"
              />
            </svg>
          </button>
        </div>
      </header>

      <!-- Settings Modal -->
      <div class="modal-overlay" id="settingsModal">
        <div class="modal">
          <div class="modal-header">
            <h2>Connect Google Sheet</h2>
            <button class="modal-close" id="closeModal">&times;</button>
          </div>
          <div class="modal-body">
            <div class="form-group">
              <label for="webAppUrl">Apps Script Web App URL</label>
              <input
                type="text"
                id="webAppUrl"
                placeholder="https://script.google.com/macros/s/YOUR_SCRIPT_ID/exec"
              />
              <p class="form-hint">
                Paste the Web App URL from your deployed Apps Script
              </p>
            </div>
            <div class="instructions">
              <h3>üîí Secure Setup:</h3>
              <ol>
                <li>Open your Google Sheet</li>
                <li>Go to <strong>Extensions ‚Üí Apps Script</strong></li>
                <li>Paste the script from <code>apps-script-code.js</code></li>
                <li>Click <strong>Deploy ‚Üí New deployment</strong></li>
                <li>Select type: <strong>Web app</strong></li>
                <li>Set "Who has access" to <strong>Anyone</strong></li>
                <li>Click <strong>Deploy</strong> and authorize</li>
                <li>Copy the <strong>Web app URL</strong> and paste above</li>
              </ol>
            </div>
          </div>
          <div class="modal-footer">
            <button class="btn btn-secondary" id="cancelBtn">Cancel</button>
            <button class="btn btn-primary" id="saveBtn">Connect</button>
          </div>
        </div>
      </div>

      <!-- Column Mapping Modal -->
      <div class="modal-overlay" id="mappingModal">
        <div class="modal modal-large">
          <div class="modal-header">
            <h2>Map Your Spreadsheet Columns</h2>
            <button class="modal-close" id="closeMappingModal">&times;</button>
          </div>
          <div class="modal-body">
            <p class="mapping-intro">
              Select which columns in your spreadsheet correspond to each field:
            </p>
            <div class="mapping-grid" id="mappingGrid"></div>
          </div>
          <div class="modal-footer">
            <button
              class="btn btn-danger"
              id="resetMappingBtn"
              style="margin-right: auto"
            >
              Reset Defaults
            </button>
            <button class="btn btn-secondary" id="cancelMappingBtn">
              Cancel
            </button>
            <button class="btn btn-primary" id="saveMappingBtn">
              Save Mapping
            </button>
          </div>
        </div>
      </div>

      <!-- Pending Detail Modal -->
      <div class="modal-overlay" id="pendingDetailModal">
        <div class="modal modal-fullpage">
          <div class="modal-header">
            <h2 id="pendingModalTitle">Pending Candidates</h2>
            <button class="modal-close" id="closePendingModal">&times;</button>
          </div>
          <div class="modal-body">
            <div class="pending-filters">
              <div class="filter-group search-group">
                <input
                  type="text"
                  id="searchInput"
                  class="filter-search"
                  placeholder="üîç Search name or vendor..."
                />
              </div>
              <div class="filter-group">
                <label>Technology:</label>
                <select id="filterTech" class="filter-select">
                  <option value="">All Technologies</option>
                </select>
              </div>
              <div class="filter-group">
                <label>Vendor:</label>
                <select id="filterVendor" class="filter-select">
                  <option value="">All Vendors</option>
                </select>
              </div>
              <div class="filter-stats">
                <span id="filteredCount">0</span> candidates
              </div>
            </div>
            <div class="pending-content">
              <div class="pending-grouped" id="pendingGroupedView"></div>
            </div>
          </div>
        </div>
      </div>

      <!-- Main Content -->
      <main class="main-content">
        <!-- Status Bar -->
        <div class="status-bar" id="statusBar">
          <div class="status-indicator" id="statusIndicator">
            <span class="status-dot"></span>
            <span class="status-text">Not Connected</span>
          </div>
          <div class="status-actions">
            <button
              class="btn btn-small"
              id="mapColumnsBtn"
              style="display: none"
            >
              <svg
                width="14"
                height="14"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <path
                  d="M12 3h7a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-7m0-18H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h7m0-18v18"
                />
              </svg>
              Map Columns
            </button>
            <span class="last-updated" id="lastUpdated"></span>
          </div>
        </div>

        <!-- Date Range Filter -->
        <div class="date-filter-bar hidden" id="dateFilterBar">
          <div class="date-filter-content">
            <span class="date-filter-label">üìÖ Filter by Date:</span>
            <div class="date-inputs">
              <div class="date-input-group">
                <label for="startDate">From:</label>
                <div class="date-input-wrapper">
                  <input type="date" id="startDate" class="date-input" />
                </div>
              </div>
              <div class="date-input-group">
                <label for="endDate">To:</label>
                <div class="date-input-wrapper">
                  <input type="date" id="endDate" class="date-input" />
                </div>
              </div>
              <button class="btn btn-small btn-primary" id="applyDateFilter">
                Apply
              </button>
              <button class="btn btn-small" id="clearDateFilter">Clear</button>
            </div>
            <div class="date-filter-info">
              <span id="dateFilterStatus"></span>
            </div>
            <span
              class="date-format-hint"
              title="Supported formats: 27th Oct. 2025, 27 Oct 2025, 27th October 2025"
            >
              ‚ìò Sheet format: <code>27th Oct. 2025</code>
            </span>
          </div>
        </div>

        <!-- Empty State -->
        <div class="empty-state" id="emptyState">
          <div class="empty-icon">
            <svg
              width="80"
              height="80"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="1.5"
            >
              <path
                d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"
              />
              <polyline points="14 2 14 8 20 8" />
              <line x1="16" y1="13" x2="8" y2="13" />
              <line x1="16" y1="17" x2="8" y2="17" />
            </svg>
          </div>
          <h2>No Data Source Connected</h2>
          <p>Connect your recruitment tracking Google Sheet</p>
          <button class="btn btn-primary btn-large" id="connectBtn">
            <svg
              width="20"
              height="20"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <path
                d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"
              />
              <path
                d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"
              />
            </svg>
            Connect Google Sheet
          </button>
        </div>

        <!-- Loading State -->
        <div class="loading-state" id="loadingState">
          <div class="loader"></div>
          <p>Fetching recruitment data...</p>
        </div>

        <!-- Dashboard Container -->
        <div class="dashboard-container" id="dashboardContainer">
          <!-- Top Metrics Row -->
          <section class="dashboard-section">
            <h2 class="section-title">üìä Overview</h2>
            <div class="metrics-grid metrics-4">
              <div class="metric-card metric-blue">
                <div class="metric-icon">üì•</div>
                <div class="metric-content">
                  <span class="metric-value" id="totalProfiles">0</span>
                  <span class="metric-label">Profiles Received</span>
                </div>
              </div>
              <div class="metric-card metric-purple">
                <div class="metric-icon">üìÖ</div>
                <div class="metric-content">
                  <span class="metric-value" id="interviewsScheduled">0</span>
                  <span class="metric-label">Interviews Done</span>
                </div>
              </div>
              <div class="metric-card metric-green">
                <div class="metric-icon">‚úÖ</div>
                <div class="metric-content">
                  <span class="metric-value" id="totalOffers">0</span>
                  <span class="metric-label">Offers Released</span>
                </div>
              </div>
              <div class="metric-card metric-teal">
                <div class="metric-icon">üéâ</div>
                <div class="metric-content">
                  <span class="metric-value" id="totalOnboarded">0</span>
                  <span class="metric-label">Onboarded</span>
                </div>
              </div>
            </div>
          </section>

          <!-- Screening Section -->
          <section class="dashboard-section">
            <h2 class="section-title">üìã Screening</h2>
            <div class="metrics-grid metrics-6">
              <div class="metric-card-small metric-blue">
                <span class="metric-value-small" id="screeningPending">0</span>
                <span class="metric-label-small">Pending</span>
              </div>
              <div class="metric-card-small metric-orange">
                <span class="metric-value-small" id="screeningFeedbackPending"
                  >0</span
                >
                <span class="metric-label-small">Feedback Pending</span>
              </div>
              <div class="metric-card-small metric-green">
                <span class="metric-value-small" id="screeningSelected">0</span>
                <span class="metric-label-small">Selected</span>
              </div>
              <div class="metric-card-small metric-red">
                <span class="metric-value-small" id="screeningRejected">0</span>
                <span class="metric-label-small">Rejected</span>
              </div>
              <div class="metric-card-small metric-purple">
                <span class="metric-value-small" id="screeningHold">0</span>
                <span class="metric-label-small">Hold</span>
              </div>
              <div class="metric-card-small metric-pink">
                <span class="metric-value-small" id="screeningNoShow">0</span>
                <span class="metric-label-small">No-Show</span>
              </div>
            </div>
          </section>

          <!-- Interview Funnel -->
          <section class="dashboard-section">
            <h2 class="section-title">üéØ Interview Funnel (Post Screening)</h2>
            <div class="funnel-container">
              <div class="funnel-stage">
                <div class="funnel-bar">
                  <span class="funnel-count" id="rfReachedCount">0</span>
                  <span class="funnel-count-label">completed</span>
                </div>
                <span class="funnel-label">Rapid Fire</span>
                <span class="funnel-pending" id="rfPendingLabel"
                  >0 pending</span
                >
              </div>
              <div class="funnel-arrow">‚Üí</div>
              <div class="funnel-stage">
                <div class="funnel-bar">
                  <span class="funnel-count" id="l1ReachedCount">0</span>
                  <span class="funnel-count-label">completed</span>
                </div>
                <span class="funnel-label">L1 Round</span>
                <span class="funnel-pending" id="l1PendingLabel"
                  >0 pending</span
                >
              </div>
              <div class="funnel-arrow">‚Üí</div>
              <div class="funnel-stage">
                <div class="funnel-bar">
                  <span class="funnel-count" id="l2ReachedCount">0</span>
                  <span class="funnel-count-label">completed</span>
                </div>
                <span class="funnel-label">L2 Round</span>
                <span class="funnel-pending" id="l2PendingLabel"
                  >0 pending</span
                >
              </div>
              <div class="funnel-arrow">‚Üí</div>
              <div class="funnel-stage">
                <div class="funnel-bar">
                  <span class="funnel-count" id="clientReachedCount">0</span>
                  <span class="funnel-count-label">completed</span>
                </div>
                <span class="funnel-label">Client Round</span>
                <span class="funnel-pending" id="clientPendingLabel"
                  >0 pending</span
                >
              </div>
            </div>
          </section>

          <!-- Outcomes Grid -->
          <section class="dashboard-section">
            <h2 class="section-title">üìà Stage Outcomes</h2>
            <div class="outcomes-grid">
              <!-- Rapid Fire Outcome -->
              <div class="outcome-card">
                <div class="outcome-header">
                  <h3>Rapid Fire</h3>
                  <span class="outcome-pending-badge" id="rfPendingBadge"
                    >0 pending</span
                  >
                </div>
                <div class="outcome-bars">
                  <div class="outcome-row">
                    <span class="outcome-label">‚úÖ Selected</span>
                    <div class="outcome-bar-container">
                      <div
                        class="outcome-bar outcome-success"
                        id="rfSelectedBar"
                      ></div>
                    </div>
                    <span class="outcome-value" id="rfSelected">0</span>
                  </div>
                  <div class="outcome-row">
                    <span class="outcome-label">‚ùå Rejected</span>
                    <div class="outcome-bar-container">
                      <div
                        class="outcome-bar outcome-danger"
                        id="rfRejectedBar"
                      ></div>
                    </div>
                    <span class="outcome-value" id="rfRejected">0</span>
                  </div>
                  <div class="outcome-row">
                    <span class="outcome-label">üö´ Dropped</span>
                    <div class="outcome-bar-container">
                      <div
                        class="outcome-bar outcome-muted"
                        id="rfDroppedBar"
                      ></div>
                    </div>
                    <span class="outcome-value" id="rfDropped">0</span>
                  </div>
                  <div class="outcome-row">
                    <span class="outcome-label">üìÖ Rescheduled</span>
                    <div class="outcome-bar-container">
                      <div
                        class="outcome-bar outcome-warning"
                        id="rfRescheduleBar"
                      ></div>
                    </div>
                    <span class="outcome-value" id="rfReschedule">0</span>
                  </div>
                  <div class="outcome-row">
                    <span class="outcome-label">‚è≥ To Be Rescheduled</span>
                    <div class="outcome-bar-container">
                      <div
                        class="outcome-bar outcome-info"
                        id="rfToBeScheduledBar"
                      ></div>
                    </div>
                    <span class="outcome-value" id="rfToBeScheduled">0</span>
                  </div>
                  <div class="outcome-row">
                    <span class="outcome-label">üí¨ Feedback Pending</span>
                    <div class="outcome-bar-container">
                      <div
                        class="outcome-bar outcome-pending"
                        id="rfFeedbackPendingBar"
                      ></div>
                    </div>
                    <span class="outcome-value" id="rfFeedbackPending">0</span>
                  </div>
                </div>
              </div>

              <!-- L1 Outcome -->
              <div class="outcome-card">
                <div class="outcome-header">
                  <h3>L1 Technical</h3>
                  <span class="outcome-pending-badge" id="l1PendingBadge"
                    >0 pending</span
                  >
                </div>
                <div class="outcome-bars">
                  <div class="outcome-row">
                    <span class="outcome-label">‚úÖ Selected</span>
                    <div class="outcome-bar-container">
                      <div
                        class="outcome-bar outcome-success"
                        id="l1SelectedBar"
                      ></div>
                    </div>
                    <span class="outcome-value" id="l1Selected">0</span>
                  </div>
                  <div class="outcome-row">
                    <span class="outcome-label">‚ùå Rejected</span>
                    <div class="outcome-bar-container">
                      <div
                        class="outcome-bar outcome-danger"
                        id="l1RejectedBar"
                      ></div>
                    </div>
                    <span class="outcome-value" id="l1Rejected">0</span>
                  </div>
                  <div class="outcome-row">
                    <span class="outcome-label">üö´ Dropped</span>
                    <div class="outcome-bar-container">
                      <div
                        class="outcome-bar outcome-muted"
                        id="l1DroppedBar"
                      ></div>
                    </div>
                    <span class="outcome-value" id="l1Dropped">0</span>
                  </div>
                  <div class="outcome-row">
                    <span class="outcome-label">üìÖ Rescheduled</span>
                    <div class="outcome-bar-container">
                      <div
                        class="outcome-bar outcome-warning"
                        id="l1RescheduleBar"
                      ></div>
                    </div>
                    <span class="outcome-value" id="l1Reschedule">0</span>
                  </div>
                  <div class="outcome-row">
                    <span class="outcome-label">‚è≥ To Be Rescheduled</span>
                    <div class="outcome-bar-container">
                      <div
                        class="outcome-bar outcome-info"
                        id="l1ToBeScheduledBar"
                      ></div>
                    </div>
                    <span class="outcome-value" id="l1ToBeScheduled">0</span>
                  </div>
                  <div class="outcome-row">
                    <span class="outcome-label">üí¨ Feedback Pending</span>
                    <div class="outcome-bar-container">
                      <div
                        class="outcome-bar outcome-pending"
                        id="l1FeedbackPendingBar"
                      ></div>
                    </div>
                    <span class="outcome-value" id="l1FeedbackPending">0</span>
                  </div>
                </div>
              </div>

              <!-- L2 Outcome -->
              <div class="outcome-card">
                <div class="outcome-header">
                  <h3>L2 Technical</h3>
                  <span class="outcome-pending-badge" id="l2PendingBadge"
                    >0 pending</span
                  >
                </div>
                <div class="outcome-bars">
                  <div class="outcome-row">
                    <span class="outcome-label">‚úÖ Selected</span>
                    <div class="outcome-bar-container">
                      <div
                        class="outcome-bar outcome-success"
                        id="l2SelectedBar"
                      ></div>
                    </div>
                    <span class="outcome-value" id="l2Selected">0</span>
                  </div>
                  <div class="outcome-row">
                    <span class="outcome-label">‚ùå Rejected</span>
                    <div class="outcome-bar-container">
                      <div
                        class="outcome-bar outcome-danger"
                        id="l2RejectedBar"
                      ></div>
                    </div>
                    <span class="outcome-value" id="l2Rejected">0</span>
                  </div>
                  <div class="outcome-row">
                    <span class="outcome-label">üö´ Dropped</span>
                    <div class="outcome-bar-container">
                      <div
                        class="outcome-bar outcome-muted"
                        id="l2DroppedBar"
                      ></div>
                    </div>
                    <span class="outcome-value" id="l2Dropped">0</span>
                  </div>
                  <div class="outcome-row">
                    <span class="outcome-label">üìÖ Rescheduled</span>
                    <div class="outcome-bar-container">
                      <div
                        class="outcome-bar outcome-warning"
                        id="l2RescheduleBar"
                      ></div>
                    </div>
                    <span class="outcome-value" id="l2Reschedule">0</span>
                  </div>
                  <div class="outcome-row">
                    <span class="outcome-label">‚è≥ To Be Rescheduled</span>
                    <div class="outcome-bar-container">
                      <div
                        class="outcome-bar outcome-info"
                        id="l2ToBeScheduledBar"
                      ></div>
                    </div>
                    <span class="outcome-value" id="l2ToBeScheduled">0</span>
                  </div>
                  <div class="outcome-row">
                    <span class="outcome-label">üí¨ Feedback Pending</span>
                    <div class="outcome-bar-container">
                      <div
                        class="outcome-bar outcome-pending"
                        id="l2FeedbackPendingBar"
                      ></div>
                    </div>
                    <span class="outcome-value" id="l2FeedbackPending">0</span>
                  </div>
                </div>
              </div>

              <!-- Client Round Outcome -->
              <div class="outcome-card">
                <div class="outcome-header">
                  <h3>Client Round</h3>
                  <span class="outcome-pending-badge" id="clientPendingBadge"
                    >0 pending</span
                  >
                </div>
                <div class="outcome-bars">
                  <div class="outcome-row">
                    <span class="outcome-label">‚úÖ Selected</span>
                    <div class="outcome-bar-container">
                      <div
                        class="outcome-bar outcome-success"
                        id="clientSelectedBar"
                      ></div>
                    </div>
                    <span class="outcome-value" id="clientSelected">0</span>
                  </div>
                  <div class="outcome-row">
                    <span class="outcome-label">‚ùå Rejected</span>
                    <div class="outcome-bar-container">
                      <div
                        class="outcome-bar outcome-danger"
                        id="clientRejectedBar"
                      ></div>
                    </div>
                    <span class="outcome-value" id="clientRejected">0</span>
                  </div>
                  <div class="outcome-row">
                    <span class="outcome-label">üö´ Dropped</span>
                    <div class="outcome-bar-container">
                      <div
                        class="outcome-bar outcome-muted"
                        id="clientDroppedBar"
                      ></div>
                    </div>
                    <span class="outcome-value" id="clientDropped">0</span>
                  </div>
                  <div class="outcome-row">
                    <span class="outcome-label">üìÖ Rescheduled</span>
                    <div class="outcome-bar-container">
                      <div
                        class="outcome-bar outcome-warning"
                        id="clientRescheduleBar"
                      ></div>
                    </div>
                    <span class="outcome-value" id="clientReschedule">0</span>
                  </div>
                  <div class="outcome-row">
                    <span class="outcome-label">‚è≥ To Be Rescheduled</span>
                    <div class="outcome-bar-container">
                      <div
                        class="outcome-bar outcome-info"
                        id="clientToBeScheduledBar"
                      ></div>
                    </div>
                    <span class="outcome-value" id="clientToBeScheduled"
                      >0</span
                    >
                  </div>
                  <div class="outcome-row">
                    <span class="outcome-label">üí¨ Feedback Pending</span>
                    <div class="outcome-bar-container">
                      <div
                        class="outcome-bar outcome-pending"
                        id="clientFeedbackPendingBar"
                      ></div>
                    </div>
                    <span class="outcome-value" id="clientFeedbackPending"
                      >0</span
                    >
                  </div>
                </div>
              </div>
            </div>
          </section>

          <!-- Vendor Performance -->
          <section class="dashboard-section">
            <h2 class="section-title">üë• Vendor Performance</h2>
            <div class="vendor-controls">
              <div class="table-legend table-legend-inline">
                <span class="legend-title">Legend:</span>
                <span class="legend-item">
                  <span class="legend-dot success"></span> Selected
                </span>
                <span class="legend-item">
                  <span class="legend-dot danger"></span> Rejected
                </span>
                <span class="legend-item">
                  <span class="legend-dot warning"></span> Pending
                </span>
                <span class="legend-item">
                  <span class="legend-dot hold"></span> On Hold
                </span>
                <span class="legend-item">
                  <span class="legend-dot info"></span> Rescheduled
                </span>
                <span class="legend-item">
                  <span class="legend-dot purple"></span> To Be Rescheduled
                </span>
              </div>
              <div class="vendor-search">
                <input
                  type="text"
                  id="vendorSearchInput"
                  class="filter-search"
                  placeholder="üîç Search vendor..."
                />
              </div>
            </div>
            <div class="table-container">
              <table class="data-table" id="vendorTable">
                <thead>
                  <tr>
                    <th class="sortable" data-sort="vendor">
                      Vendor <span class="sort-icon">‚Üï</span>
                    </th>
                    <th class="sortable" data-sort="profiles">
                      Profiles <span class="sort-icon">‚Üï</span>
                    </th>
                    <th>Screening</th>
                    <th>RF</th>
                    <th>L1</th>
                    <th>L2</th>
                    <th>Client</th>
                    <th>Offers</th>
                    <th>Joined</th>
                    <th
                      class="sortable"
                      data-sort="successRate"
                      title="Formula: (Screening Selected √∑ Profiles) √ó 100"
                    >
                      Success % <span class="info-icon">‚ìò</span>
                      <span class="sort-icon">‚Üï</span>
                    </th>
                  </tr>
                </thead>
                <tbody id="vendorTableBody"></tbody>
              </table>
            </div>
          </section>

          <!-- Technology & Experience Insights -->
          <section class="dashboard-section">
            <h2 class="section-title">üìä Hiring Insights</h2>
            <div class="insights-grid">
              <!-- Technology Performance -->
              <div class="insights-card insights-card-wide">
                <h3>Technology Performance</h3>
                <div class="table-container compact">
                  <table class="data-table" id="techTable">
                    <thead>
                      <tr>
                        <th class="sortable-tech" data-sort="tech">
                          Technology <span class="sort-icon">‚Üï</span>
                        </th>
                        <th class="sortable-tech" data-sort="profiles">
                          Profiles <span class="sort-icon">‚Üï</span>
                        </th>
                        <th>Screened</th>
                        <th class="sortable-tech" data-sort="offers">
                          Offers <span class="sort-icon">‚Üï</span>
                        </th>
                        <th
                          class="sortable-tech"
                          data-sort="rate"
                          title="Formula: (Screened √∑ Profiles) √ó 100"
                        >
                          Success % <span class="info-icon">‚ìò</span>
                          <span class="sort-icon">‚Üï</span>
                        </th>
                        <th>Avg Exp</th>
                      </tr>
                    </thead>
                    <tbody id="techTableBody"></tbody>
                  </table>
                </div>
              </div>

              <!-- Experience Distribution -->
              <div class="insights-card">
                <h3>Experience Distribution</h3>
                <div class="exp-distribution" id="expDistribution"></div>
              </div>
            </div>
          </section>
        </div>

        <!-- Error State -->
        <div class="error-state" id="errorState">
          <div class="error-icon">‚ö†Ô∏è</div>
          <h2>Unable to Load Data</h2>
          <p id="errorMessage">
            Something went wrong while fetching your data.
          </p>
          <button class="btn btn-primary" id="retryBtn">Try Again</button>
        </div>
      </main>

      <!-- Footer -->
      <footer class="footer">
        <p>üîí Secure connection via Google Apps Script</p>
      </footer>
    </div>

    <script src="js/config.js"></script>
    <script src="js/sheets.js"></script>
    <script src="js/analytics.js"></script>
    <script src="js/app.js"></script>
  </body>
</html>
